{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\Valentin\\\\Desktop\\\\Developper\\\\LGBTapp\\\\Real\\\\frontend\\\\components\\\\main\\\\Setting.js\";\nimport React, { useState, useEffect } from 'react';\nimport Button from \"react-native-web/dist/exports/Button\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport firebase from 'firebase';\n\nrequire('firebase/firestore');\n\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { fetchUsersData } from \"../../redux/actions/index\";\nimport * as ImagePicker from 'expo-image-picker';\n\nfunction Setting(props) {\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      user = _useState2[0],\n      SetUser = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      image = _useState4[0],\n      setImage = _useState4[1];\n\n  var _useState5 = useState(0),\n      _useState6 = _slicedToArray(_useState5, 2),\n      nameValue = _useState6[0],\n      setNameValue = _useState6[1];\n\n  var _useState7 = useState(null),\n      _useState8 = _slicedToArray(_useState7, 2),\n      error = _useState8[0],\n      setError = _useState8[1];\n\n  useEffect(function () {\n    firebase.firestore().collection(\"users\").doc(firebase.auth().currentUser.uid).get().then(function (snapshot) {\n      if (snapshot.exists) {\n        SetUser(snapshot.data());\n      } else {\n        console.log(\"Setting user does not exist\");\n      }\n    });\n  }, [props]);\n\n  var ChangeProfile = function ChangeProfile() {\n    var result, uri, childPath, response, blob, task, taskProgress, taskCompleted, taskError;\n    return _regeneratorRuntime.async(function ChangeProfile$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({\n              mediaTypes: ImagePicker.MediaTypeOptions.Images,\n              allowsEditing: true,\n              aspect: [1, 1],\n              quality: 1\n            }));\n\n          case 2:\n            result = _context.sent;\n            console.log(result);\n\n            if (result.cancelled) {\n              _context.next = 20;\n              break;\n            }\n\n            setImage(result.uri);\n            uri = image;\n            childPath = \"picture/\" + firebase.auth().currentUser.uid + \"/\" + Math.random().toString(36);\n            console.log(childPath);\n            _context.next = 11;\n            return _regeneratorRuntime.awrap(fetch(uri));\n\n          case 11:\n            response = _context.sent;\n            _context.next = 14;\n            return _regeneratorRuntime.awrap(response.blob());\n\n          case 14:\n            blob = _context.sent;\n            task = firebase.storage().ref().child(childPath).put(blob);\n\n            taskProgress = function taskProgress(snapshot) {\n              console.log(\"transferred: \" + snapshot.bytesTransferred);\n            };\n\n            taskCompleted = function taskCompleted() {\n              task.snapshot.ref.getDownloadURL().then(function (snapshot) {\n                savePostData(snapshot);\n                console.log(snapshot);\n              });\n            };\n\n            taskError = function taskError(snapshot) {\n              console.log(snapshot);\n            };\n\n            task.on(\"state_changed\", taskProgress, taskError, taskCompleted);\n\n          case 20:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var savePostData = function savePostData(downloadURL) {\n    firebase.firestore().collection('users').doc(firebase.auth().currentUser.uid).set({\n      name: user.name,\n      email: user.email,\n      picture: downloadURL\n    });\n  };\n\n  if (user === null) {\n    return React.createElement(View, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 16\n      }\n    });\n  }\n\n  return React.createElement(View, {\n    style: styles.header,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }\n  }, React.createElement(TouchableOpacity, {\n    onPress: function onPress() {\n      return props.navigation.navigate(\"Profile\", {\n        uid: firebase.auth().currentUser.uid\n      });\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 13\n    }\n  }, React.createElement(Image, {\n    source: require(\"../../assets/fleche.jpg\"),\n    style: {\n      width: 48,\n      height: 48,\n      marginTop: 25\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 17\n    }\n  })), React.createElement(Text, {\n    style: styles.headerText,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 13\n    }\n  }, \"Profile \", user.name), React.createElement(View, {\n    style: styles.container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 13\n    }\n  }, user.picture ? React.createElement(Image, {\n    source: {\n      uri: user.picture\n    },\n    style: {\n      width: 48,\n      height: 48,\n      borderRadius: 10,\n      position: 'absolute',\n      margin: 20\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 21\n    }\n  }) : React.createElement(Image, {\n    source: require(\"../../assets/friend.png\"),\n    style: {\n      width: 48,\n      height: 48,\n      borderRadius: 10,\n      position: 'absolute',\n      margin: 20\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 21\n    }\n  }), React.createElement(TouchableOpacity, {\n    style: styles.button,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 13\n    }\n  }, React.createElement(Button, {\n    title: \"Change profile picture\",\n    onPress: function onPress() {\n      return ChangeProfile();\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 17\n    }\n  })), React.createElement(Text, {\n    style: {\n      fontSize: 16\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }\n  }, \"Name: \"), React.createElement(TextInput, {\n    placeholder: user.name,\n    style: styles.textInput,\n    maxLength: 15,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 13\n    }\n  }), React.createElement(Text, {\n    style: styles.text,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 13\n    }\n  }, \"Your Email : \"), React.createElement(Text, {\n    style: {\n      fontSize: 16\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 13\n    }\n  }, user.email), React.createElement(Text, {\n    style: styles.text,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 13\n    }\n  }, \"Bio : \"), React.createElement(TextInput, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 13\n    }\n  }), error && React.createElement(Text, {\n    style: styles.error,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 23\n    }\n  }, error), React.createElement(TouchableOpacity, {\n    style: {\n      marginTop: 50\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 13\n    }\n  }, React.createElement(Button, {\n    title: \"Submit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 17\n    }\n  }))));\n}\n\nvar styles = StyleSheet.create({\n  header: {\n    flex: 1,\n    margin: 5\n  },\n  container: {\n    flex: 1,\n    padding: 25,\n    marginTop: 25\n  },\n  textInput: {\n    fontSize: 16,\n    borderColor: 'black',\n    borderWidth: 1,\n    borderRadius: 10,\n    width: 150,\n    marginTop: 10\n  },\n  button: {\n    height: 60,\n    alignItems: 'flex-end'\n  },\n  headerText: {\n    fontSize: 20,\n    position: 'absolute',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginTop: 35,\n    right: '50%'\n  },\n  text: {\n    marginTop: 25,\n    fontSize: 16\n  },\n  error: {\n    fontSize: 20,\n    color: 'red',\n    justifyContent: 'center',\n    alignItems: 'center'\n  }\n});\n\nvar mapStateToProps = function mapStateToProps(store) {\n  return {\n    users: store.usersState.users\n  };\n};\n\nvar mapDispatchProps = function mapDispatchProps(dispatch) {\n  return bindActionCreators({\n    fetchUsersData: fetchUsersData\n  }, dispatch);\n};\n\nexport default connect(mapStateToProps, mapDispatchProps)(Setting);","map":{"version":3,"sources":["C:/Users/Valentin/Desktop/Developper/LGBTapp/Real/frontend/components/main/Setting.js"],"names":["React","useState","useEffect","firebase","require","connect","bindActionCreators","fetchUsersData","ImagePicker","Setting","props","user","SetUser","image","setImage","nameValue","setNameValue","error","setError","firestore","collection","doc","auth","currentUser","uid","get","then","snapshot","exists","data","console","log","ChangeProfile","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","Images","allowsEditing","aspect","quality","result","cancelled","uri","childPath","Math","random","toString","fetch","response","blob","task","storage","ref","child","put","taskProgress","bytesTransferred","taskCompleted","getDownloadURL","savePostData","taskError","on","downloadURL","set","name","email","picture","styles","header","navigation","navigate","width","height","marginTop","headerText","container","borderRadius","position","margin","button","fontSize","textInput","text","StyleSheet","create","flex","padding","borderColor","borderWidth","alignItems","justifyContent","right","color","mapStateToProps","store","users","usersState","mapDispatchProps","dispatch"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Button, View, Text, TextInput, Image, TouchableOpacity, FlatList, StyleSheet } from 'react-native';\r\n\r\nimport firebase from 'firebase';\r\nrequire('firebase/firestore')\r\n\r\nimport { connect } from 'react-redux';\r\nimport { bindActionCreators } from 'redux'\r\nimport { fetchUsersData } from '../../redux/actions/index'\r\nimport * as ImagePicker from 'expo-image-picker';\r\n\r\nfunction Setting(props) {\r\n\r\n    const [user, SetUser] = useState(null);\r\n    const [image, setImage] = useState(null);\r\n    const [nameValue, setNameValue] = useState(0);\r\n    const [error, setError] = useState(null);\r\n\r\n    useEffect(() => {\r\n        firebase.firestore()\r\n        .collection(\"users\")\r\n        .doc(firebase.auth().currentUser.uid)\r\n        .get()\r\n        .then((snapshot) => {\r\n            if (snapshot.exists) {\r\n                SetUser(snapshot.data())\r\n            } else {\r\n                console.log(\"Setting user does not exist\")\r\n            }\r\n        })\r\n    }, [props])\r\n\r\n    const ChangeProfile = async () => {\r\n        let result = await ImagePicker.launchImageLibraryAsync({\r\n            mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n            allowsEditing: true,\r\n            aspect: [1, 1],\r\n            quality: 1,\r\n        });\r\n        console.log(result);\r\n      \r\n        if (!result.cancelled) {\r\n            setImage(result.uri);\r\n            const uri = image;\r\n            const childPath = `picture/${firebase.auth().currentUser.uid}/${Math.random().toString(36)}`;\r\n            console.log(childPath)\r\n\r\n            const response = await fetch(uri);\r\n            const blob = await response.blob();\r\n\r\n            const task = firebase\r\n                .storage()\r\n                .ref()\r\n                .child(childPath)\r\n                .put(blob);\r\n\r\n            const taskProgress = snapshot => {\r\n                console.log(`transferred: ${snapshot.bytesTransferred}`)\r\n            }\r\n\r\n            const taskCompleted = () => {\r\n                task.snapshot.ref.getDownloadURL().then((snapshot) => {\r\n                    savePostData(snapshot);\r\n                    console.log(snapshot)\r\n                })\r\n            }\r\n\r\n            const taskError = snapshot => {\r\n                console.log(snapshot)\r\n            }\r\n\r\n            task.on(\"state_changed\", taskProgress, taskError, taskCompleted);\r\n        }\r\n    }\r\n\r\n    const savePostData = (downloadURL) => {\r\n\r\n        firebase.firestore()\r\n            .collection('users')\r\n            .doc(firebase.auth().currentUser.uid)\r\n            .set({\r\n                name: user.name,\r\n                email: user.email,\r\n                picture: downloadURL\r\n            })\r\n    }\r\n\r\n    if (user === null) {\r\n        return <View />\r\n    }\r\n\r\n    return (\r\n        <View style={styles.header}>\r\n            <TouchableOpacity\r\n                onPress={() => props.navigation.navigate(\"Profile\", {uid: firebase.auth().currentUser.uid})}\r\n            >\r\n                <Image\r\n                    source={require('../../assets/fleche.jpg')}\r\n                    style={{width: 48, height: 48, marginTop: 25}}\r\n                />\r\n            </TouchableOpacity>\r\n            <Text style={styles.headerText}>Profile {user.name}</Text>\r\n            <View style={styles.container}>\r\n             {user.picture ? (\r\n                    <Image\r\n                        source={{uri: user.picture}}\r\n                        style={{width: 48, height: 48, borderRadius: 10, position: 'absolute', margin: 20}}\r\n                    />) : (\r\n                    <Image\r\n                        source={require('../../assets/friend.png')}\r\n                        style={{width: 48, height: 48, borderRadius: 10, position: 'absolute', margin: 20}}\r\n                    />\r\n                )}\r\n\r\n            <TouchableOpacity style={styles.button}>\r\n                <Button\r\n                    title=\"Change profile picture\"\r\n                    onPress={() => ChangeProfile()}\r\n                />\r\n            </TouchableOpacity>\r\n            <Text style={{fontSize: 16}}>Name: </Text>\r\n            <TextInput\r\n                placeholder={user.name}\r\n                style={styles.textInput}\r\n                maxLength={15}\r\n            />\r\n            \r\n            <Text style={styles.text}>Your Email : </Text>\r\n            <Text style={{ fontSize: 16 }}>{user.email}</Text>\r\n            <Text style={styles.text}>Bio : </Text>\r\n            <TextInput></TextInput>\r\n\r\n            {error && <Text style={styles.error}>{error}</Text>}\r\n            \r\n            <TouchableOpacity style={{ marginTop: 50}}>\r\n                <Button\r\n                    title='Submit'\r\n                />\r\n            </TouchableOpacity>\r\n            </View>\r\n        </View>\r\n    )\r\n\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    header: {\r\n        flex: 1,\r\n        margin: 5\r\n    },\r\n    container: {\r\n        flex: 1,\r\n        padding: 25,\r\n        marginTop: 25\r\n    },\r\n    textInput: {\r\n        fontSize: 16,\r\n        borderColor: 'black',\r\n        borderWidth: 1,\r\n        borderRadius: 10,\r\n        width: 150,\r\n        marginTop: 10,\r\n        \r\n    },\r\n    button: {\r\n        height: 60, alignItems: 'flex-end'\r\n    },\r\n    headerText: {\r\n        fontSize: 20,\r\n        position: 'absolute',\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        marginTop: 35,\r\n        right: '50%', \r\n    },\r\n    text: {\r\n        marginTop: 25,\r\n        fontSize: 16\r\n    },\r\n    error: {\r\n        fontSize: 20,\r\n        color: 'red',\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n    }\r\n})\r\n\r\nconst mapStateToProps = (store) => ({\r\n    users: store.usersState.users\r\n})\r\nconst mapDispatchProps = (dispatch) => bindActionCreators({ fetchUsersData }, dispatch);\r\n\r\nexport default connect(mapStateToProps, mapDispatchProps)(Setting);"]},"metadata":{},"sourceType":"module"}