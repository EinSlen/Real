{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\Valentin\\\\Desktop\\\\Developper\\\\LGBTapp\\\\Real\\\\frontend\\\\components\\\\main\\\\Setting.js\";\nimport React, { useState, useEffect } from 'react';\nimport Button from \"react-native-web/dist/exports/Button\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport firebase from 'firebase';\n\nrequire('firebase/firestore');\n\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { fetchUsersData } from \"../../redux/actions/index\";\nimport * as ImagePicker from 'expo-image-picker';\n\nfunction Setting(props) {\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      user = _useState2[0],\n      SetUser = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      image = _useState4[0],\n      setImage = _useState4[1];\n\n  var _useState5 = useState(null),\n      _useState6 = _slicedToArray(_useState5, 2),\n      nameValue = _useState6[0],\n      setNameValue = _useState6[1];\n\n  var _useState7 = useState(null),\n      _useState8 = _slicedToArray(_useState7, 2),\n      bio = _useState8[0],\n      setBio = _useState8[1];\n\n  var _useState9 = useState(\"\"),\n      _useState10 = _slicedToArray(_useState9, 2),\n      error = _useState10[0],\n      setError = _useState10[1];\n\n  useEffect(function () {\n    firebase.firestore().collection(\"users\").doc(firebase.auth().currentUser.uid).get().then(function (snapshot) {\n      if (snapshot.exists) {\n        SetUser(snapshot.data());\n      } else {\n        console.log(\"Setting user does not exist\");\n      }\n    });\n  }, [props]);\n\n  var ChangeProfile = function ChangeProfile() {\n    var result, uri, childPath, response, blob, task, taskProgress, taskCompleted, taskError;\n    return _regeneratorRuntime.async(function ChangeProfile$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({\n              mediaTypes: ImagePicker.MediaTypeOptions.Images,\n              allowsEditing: true,\n              aspect: [1, 1],\n              quality: 1\n            }));\n\n          case 2:\n            result = _context.sent;\n            console.log(result);\n\n            if (result.cancelled) {\n              _context.next = 20;\n              break;\n            }\n\n            setImage(result.uri);\n            uri = image;\n            childPath = \"picture/\" + firebase.auth().currentUser.uid + \"/\" + Math.random().toString(36);\n            console.log(childPath);\n            _context.next = 11;\n            return _regeneratorRuntime.awrap(fetch(uri));\n\n          case 11:\n            response = _context.sent;\n            _context.next = 14;\n            return _regeneratorRuntime.awrap(response.blob());\n\n          case 14:\n            blob = _context.sent;\n            task = firebase.storage().ref().child(childPath).put(blob);\n\n            taskProgress = function taskProgress(snapshot) {\n              console.log(\"transferred: \" + snapshot.bytesTransferred);\n            };\n\n            taskCompleted = function taskCompleted() {\n              task.snapshot.ref.getDownloadURL().then(function (snapshot) {\n                savePostData(snapshot);\n                console.log(snapshot);\n              });\n            };\n\n            taskError = function taskError(snapshot) {\n              console.log(snapshot);\n            };\n\n            task.on(\"state_changed\", taskProgress, taskError, taskCompleted);\n\n          case 20:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var savePostData = function savePostData(downloadURL) {\n    firebase.firestore().collection('users').doc(firebase.auth().currentUser.uid).set({\n      name: user.name,\n      email: user.email,\n      picture: downloadURL\n    });\n  };\n\n  var onLogout = function onLogout() {\n    firebase.auth().signOut();\n  };\n\n  var Submit = function Submit() {\n    if (nameValue.length < 5) setError(\"Your name is too small.\");\n    if (bio.length > 100) setError(\"Your biography is too big.\");\n  };\n\n  if (user === null) {\n    return React.createElement(View, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 16\n      }\n    });\n  }\n\n  return React.createElement(View, {\n    style: styles.header,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 9\n    }\n  }, React.createElement(TouchableOpacity, {\n    onPress: function onPress() {\n      return props.navigation.navigate(\"Profile\", {\n        uid: firebase.auth().currentUser.uid\n      });\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }\n  }, React.createElement(Image, {\n    source: require(\"../../assets/fleche.jpg\"),\n    style: {\n      width: 48,\n      height: 48,\n      marginTop: 25\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 17\n    }\n  })), React.createElement(Text, {\n    style: styles.headerText,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 13\n    }\n  }, \"Profile \", user.name), React.createElement(TouchableOpacity, {\n    style: styles.logoutButton,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 13\n    }\n  }, React.createElement(Button, {\n    title: \"Logout\",\n    onPress: function onPress() {\n      return onLogout();\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 17\n    }\n  })), React.createElement(View, {\n    style: styles.container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }\n  }, user.picture ? React.createElement(Image, {\n    source: {\n      uri: user.picture\n    },\n    style: {\n      width: 48,\n      height: 48,\n      borderRadius: 10,\n      position: 'absolute',\n      margin: 20\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 21\n    }\n  }) : React.createElement(Image, {\n    source: require(\"../../assets/friend.png\"),\n    style: {\n      width: 48,\n      height: 48,\n      borderRadius: 10,\n      position: 'absolute',\n      margin: 20\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 21\n    }\n  }), React.createElement(TouchableOpacity, {\n    style: styles.button,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 13\n    }\n  }, React.createElement(Button, {\n    title: \"Change profile picture\",\n    onPress: function onPress() {\n      return ChangeProfile();\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 17\n    }\n  })), React.createElement(Text, {\n    style: {\n      fontSize: 16\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 13\n    }\n  }, \"Name: \"), React.createElement(TextInput, {\n    placeholder: user.name,\n    style: styles.textInput,\n    maxLength: 15,\n    onChangeText: function onChangeText(text) {\n      return setNameValue(text);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 13\n    }\n  }), React.createElement(Text, {\n    style: styles.text,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 13\n    }\n  }, \"Your Email : \"), React.createElement(Text, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 13\n    }\n  }, user.email), React.createElement(Button, {\n    title: \"Reset Email\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 13\n    }\n  }), React.createElement(Text, {\n    style: styles.text,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 13\n    }\n  }, \"Bio : \"), React.createElement(TextInput, {\n    style: styles.textInputBio,\n    textAlignVertical: \"top\",\n    placeholder: \"Place a bio\",\n    onChangeText: function onChangeText(text) {\n      return setBio(text);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 13\n    }\n  }), error && React.createElement(Text, {\n    style: styles.error,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 23\n    }\n  }, error), React.createElement(TouchableOpacity, {\n    style: {\n      marginTop: 50\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 13\n    }\n  }, React.createElement(Button, {\n    title: \"Submit\",\n    onPress: function onPress() {\n      return Submit();\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 17\n    }\n  }))));\n}\n\nvar styles = StyleSheet.create({\n  header: {\n    flex: 1,\n    margin: 5\n  },\n  container: {\n    flex: 1,\n    padding: 25,\n    marginTop: 25\n  },\n  textInput: {\n    fontSize: 16,\n    borderColor: 'black',\n    borderWidth: 1,\n    borderRadius: 10,\n    width: 150,\n    marginTop: 10\n  },\n  textInputBio: {\n    fontSize: 16,\n    borderColor: 'black',\n    borderWidth: 1,\n    borderRadius: 10,\n    height: 150,\n    marginTop: 10\n  },\n  textInputEmail: {\n    fontSize: 16,\n    borderColor: 'black',\n    borderWidth: 1,\n    borderRadius: 10,\n    width: 250,\n    height: 50,\n    marginTop: 10\n  },\n  button: {\n    height: 60,\n    alignItems: 'flex-end'\n  },\n  headerText: {\n    fontSize: 20,\n    position: 'absolute',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginTop: 35,\n    right: '50%'\n  },\n  text: {\n    marginTop: 25,\n    fontSize: 16\n  },\n  error: {\n    fontSize: 20,\n    color: 'red',\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  logoutButton: {\n    width: 120,\n    fontSize: 20,\n    position: 'absolute',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginTop: 35,\n    right: 0\n  }\n});\n\nvar mapStateToProps = function mapStateToProps(store) {\n  return {\n    users: store.usersState.users\n  };\n};\n\nvar mapDispatchProps = function mapDispatchProps(dispatch) {\n  return bindActionCreators({\n    fetchUsersData: fetchUsersData\n  }, dispatch);\n};\n\nexport default connect(mapStateToProps, mapDispatchProps)(Setting);","map":{"version":3,"sources":["C:/Users/Valentin/Desktop/Developper/LGBTapp/Real/frontend/components/main/Setting.js"],"names":["React","useState","useEffect","firebase","require","connect","bindActionCreators","fetchUsersData","ImagePicker","Setting","props","user","SetUser","image","setImage","nameValue","setNameValue","bio","setBio","error","setError","firestore","collection","doc","auth","currentUser","uid","get","then","snapshot","exists","data","console","log","ChangeProfile","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","Images","allowsEditing","aspect","quality","result","cancelled","uri","childPath","Math","random","toString","fetch","response","blob","task","storage","ref","child","put","taskProgress","bytesTransferred","taskCompleted","getDownloadURL","savePostData","taskError","on","downloadURL","set","name","email","picture","onLogout","signOut","Submit","length","styles","header","navigation","navigate","width","height","marginTop","headerText","logoutButton","container","borderRadius","position","margin","button","fontSize","textInput","text","textInputBio","StyleSheet","create","flex","padding","borderColor","borderWidth","textInputEmail","alignItems","justifyContent","right","color","mapStateToProps","store","users","usersState","mapDispatchProps","dispatch"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Button, View, Text, TextInput, Image, TouchableOpacity, FlatList, StyleSheet } from 'react-native';\r\n\r\nimport firebase from 'firebase';\r\nrequire('firebase/firestore')\r\n\r\nimport { connect } from 'react-redux';\r\nimport { bindActionCreators } from 'redux'\r\nimport { fetchUsersData } from '../../redux/actions/index'\r\nimport * as ImagePicker from 'expo-image-picker';\r\n\r\nfunction Setting(props) {\r\n\r\n    const [user, SetUser] = useState(null);\r\n    const [image, setImage] = useState(null);\r\n    const [nameValue, setNameValue] = useState(null);\r\n    const [bio, setBio] = useState(null);\r\n    const [error, setError] = useState(\"\");\r\n\r\n    useEffect(() => {\r\n        firebase.firestore()\r\n        .collection(\"users\")\r\n        .doc(firebase.auth().currentUser.uid)\r\n        .get()\r\n        .then((snapshot) => {\r\n            if (snapshot.exists) {\r\n                SetUser(snapshot.data())\r\n            } else {\r\n                console.log(\"Setting user does not exist\")\r\n            }\r\n        })\r\n    }, [props])\r\n\r\n    const ChangeProfile = async () => {\r\n        let result = await ImagePicker.launchImageLibraryAsync({\r\n            mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n            allowsEditing: true,\r\n            aspect: [1, 1],\r\n            quality: 1,\r\n        });\r\n        console.log(result);\r\n      \r\n        if (!result.cancelled) {\r\n            setImage(result.uri);\r\n            const uri = image;\r\n            const childPath = `picture/${firebase.auth().currentUser.uid}/${Math.random().toString(36)}`;\r\n            console.log(childPath)\r\n\r\n            const response = await fetch(uri);\r\n            const blob = await response.blob();\r\n\r\n            const task = firebase\r\n                .storage()\r\n                .ref()\r\n                .child(childPath)\r\n                .put(blob);\r\n\r\n            const taskProgress = snapshot => {\r\n                console.log(`transferred: ${snapshot.bytesTransferred}`)\r\n            }\r\n\r\n            const taskCompleted = () => {\r\n                task.snapshot.ref.getDownloadURL().then((snapshot) => {\r\n                    savePostData(snapshot);\r\n                    console.log(snapshot)\r\n                })\r\n            }\r\n\r\n            const taskError = snapshot => {\r\n                console.log(snapshot)\r\n            }\r\n\r\n            task.on(\"state_changed\", taskProgress, taskError, taskCompleted);\r\n        }\r\n    }\r\n\r\n    const savePostData = (downloadURL) => {\r\n\r\n        firebase.firestore()\r\n            .collection('users')\r\n            .doc(firebase.auth().currentUser.uid)\r\n            .set({\r\n                name: user.name,\r\n                email: user.email,\r\n                picture: downloadURL\r\n            })\r\n    }\r\n\r\n    const onLogout = () => {\r\n        firebase.auth().signOut();\r\n    }\r\n\r\n    const Submit = () => {\r\n\r\n        if(nameValue.length < 5) setError(\"Your name is too small.\")\r\n        if(bio.length > 100) setError(\"Your biography is too big.\")\r\n\r\n    }\r\n\r\n    if (user === null) {\r\n        return <View />\r\n    }\r\n\r\n    return (\r\n        <View style={styles.header}>\r\n            <TouchableOpacity\r\n                onPress={() => props.navigation.navigate(\"Profile\", {uid: firebase.auth().currentUser.uid})}\r\n            >\r\n                <Image\r\n                    source={require('../../assets/fleche.jpg')}\r\n                    style={{width: 48, height: 48, marginTop: 25}}\r\n                />\r\n            </TouchableOpacity>\r\n            <Text style={styles.headerText}>Profile {user.name}</Text>\r\n            <TouchableOpacity style={styles.logoutButton}>\r\n                <Button\r\n                    title=\"Logout\"\r\n                    onPress={() => onLogout()}\r\n                />\r\n            </TouchableOpacity>\r\n            <View style={styles.container}>\r\n             {user.picture ? (\r\n                    <Image\r\n                        source={{uri: user.picture}}\r\n                        style={{width: 48, height: 48, borderRadius: 10, position: 'absolute', margin: 20}}\r\n                    />) : (\r\n                    <Image\r\n                        source={require('../../assets/friend.png')}\r\n                        style={{width: 48, height: 48, borderRadius: 10, position: 'absolute', margin: 20}}\r\n                    />\r\n                )}\r\n\r\n            <TouchableOpacity style={styles.button}>\r\n                <Button\r\n                    title=\"Change profile picture\"\r\n                    onPress={() => ChangeProfile()}\r\n                />\r\n            </TouchableOpacity>\r\n            <Text style={{fontSize: 16}}>Name: </Text>\r\n            <TextInput\r\n                placeholder={user.name}\r\n                style={styles.textInput}\r\n                maxLength={15}\r\n                onChangeText={(text) => setNameValue(text)}\r\n            />\r\n            \r\n            <Text style={styles.text}>Your Email : </Text>\r\n            <Text>{user.email}</Text>\r\n            <Button\r\n                title='Reset Email'\r\n\r\n            />\r\n            <Text style={styles.text}>Bio : </Text>\r\n            <TextInput \r\n                style={styles.textInputBio}\r\n                textAlignVertical='top'\r\n                placeholder='Place a bio'\r\n                onChangeText={(text) => setBio(text)}\r\n            />\r\n\r\n            {error && <Text style={styles.error}>{error}</Text>}\r\n            \r\n            <TouchableOpacity style={{ marginTop: 50}}>\r\n                <Button\r\n                    title='Submit'\r\n                    onPress={() => Submit()}\r\n                />\r\n            </TouchableOpacity>\r\n            </View>\r\n        </View>\r\n    )\r\n\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    header: {\r\n        flex: 1,\r\n        margin: 5\r\n    },\r\n    container: {\r\n        flex: 1,\r\n        padding: 25,\r\n        marginTop: 25\r\n    },\r\n    textInput: {\r\n        fontSize: 16,\r\n        borderColor: 'black',\r\n        borderWidth: 1,\r\n        borderRadius: 10,\r\n        width: 150,\r\n        marginTop: 10\r\n    },\r\n    textInputBio: {\r\n        fontSize: 16,\r\n        borderColor: 'black',\r\n        borderWidth: 1,\r\n        borderRadius: 10,\r\n        height: 150,\r\n        marginTop: 10\r\n\r\n    },\r\n    textInputEmail: {\r\n        fontSize: 16,\r\n        borderColor: 'black',\r\n        borderWidth: 1,\r\n        borderRadius: 10,\r\n        width: 250,\r\n        height: 50,\r\n        marginTop: 10,\r\n    },\r\n    button: {\r\n        height: 60, alignItems: 'flex-end'\r\n    },\r\n    headerText: {\r\n        fontSize: 20,\r\n        position: 'absolute',\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        marginTop: 35,\r\n        right: '50%', \r\n    },\r\n    text: {\r\n        marginTop: 25,\r\n        fontSize: 16\r\n    },\r\n    error: {\r\n        fontSize: 20,\r\n        color: 'red',\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n    },\r\n    logoutButton: {\r\n        width: 120, \r\n        fontSize: 20,\r\n        position: 'absolute',\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        marginTop: 35,\r\n        right: 0\r\n    }\r\n})\r\n\r\nconst mapStateToProps = (store) => ({\r\n    users: store.usersState.users\r\n})\r\nconst mapDispatchProps = (dispatch) => bindActionCreators({ fetchUsersData }, dispatch);\r\n\r\nexport default connect(mapStateToProps, mapDispatchProps)(Setting);"]},"metadata":{},"sourceType":"module"}